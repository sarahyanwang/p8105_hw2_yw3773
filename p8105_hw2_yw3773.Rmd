---
title: "p8105_hw2_yw3773"
output: git_document
---

```{r setup, include=FALSE}
library(readxl)
library(tidyverse)
library(constants)
```

## Problem 1
```{r}
trash_df = read_excel("Trash-Wheel-Collection-Totals-8-6-19.xlsx", sheet = "Mr. Trash Wheel") %>%
  janitor::clean_names() %>%
  select(dumpster:homes_powered) %>%
  drop_na(dumpster) %>%
  mutate(sports_balls = round(sports_balls))

eighten_prec = read_excel("Trash-Wheel-Collection-Totals-8-6-19.xlsx", sheet = "2018 Precipitation", range = "A2:B14") %>%
  drop_na() %>%
  mutate(year = 2018)
  

nineteen_prec = read_excel("Trash-Wheel-Collection-Totals-8-6-19.xlsx", sheet = "2019 Precipitation", range = "A2:B14") %>%
  drop_na() %>%
  mutate(year = 2019)

com_prec = bind_rows(eighten_prec, nineteen_prec) %>%
  janitor::clean_names() %>%
  mutate(month = month.name[as.numeric(month)]) 

nineteen_dump = trash_df %>%
  filter(year == 2019)

sum(pull(eighten_prec, Total)) ###############
median(pull(nineteen_dump, sports_balls)) ###############3
```

The Mr. Trash Wheel data set contains `r ncol(trash_df)` columns and `r nrow(trash_df)` rows. The data sets has 14 variables which are `r names(trash_df)`. The median of sports balls in a dumpster in 2019 is `r median(pull(nine_dump, sports_balls))`.

The combined 2018-2019 precipitation data set contains `r ncol(com_prec)` columns and `r nrow(com_prec)` rows. The data set has 3 variables which are `r names(com_prec)`. The total precipitation in 2018 is `r sum(pull(eighteen_prec, Total))`.

## Problem 2

```{r}
pol_month_df = read_csv("fivethirtyeight_datasets/pols-month.csv") %>%
  separate(mon, into = c("year", "month", "day")) %>%
  janitor::clean_names() %>%
  mutate(month = month.name[as.numeric(month)]) %>%
  mutate(year = as.numeric(year)) %>%
  mutate(president = ifelse(prez_dem == 0, "gop", "dem")) %>%
  select(-day, -prez_gop, -prez_dem) %>%
  mutate(month = substring(month, 0, 3))

snp_df = read_csv("fivethirtyeight_datasets/snp.csv") %>%
  janitor::clean_names() %>%
  mutate(date, date = lubridate::mdy(date)) %>% 
  separate(date, into = c("year", "month", "day")) %>% 
  mutate(year = as.numeric(year)) %>% 
  mutate(year = ifelse(year >= 2050, year - 100, year)) %>%
  mutate(month = month.name[as.numeric(month)]) %>% 
  arrange(year, month) %>%
  mutate(month = substring(month, 0, 3)) %>%
  select(-day)
 
unemploy_df = read_csv("fivethirtyeight_datasets/unemployment.csv") %>%
  pivot_longer(Jan:Dec, names_to = "month", values_to = "unem_percent") %>%
  janitor::clean_names() %>%
  mutate(year = as.numeric(year)) %>%
  arrange(year,month) 

merge_df = left_join(pol_month_df, snp_df, by = c("year", "month"))
merge_df = left_join(merge_df, unemploy_df, by = c("year", "month"))
```


# Problem 3

```{r}
baby_df = read_csv("Popular_Baby_Names.csv") %>%
  janitor::clean_names() %>%
  mutate(gender = str_to_lower(gender)) %>%
  mutate(ethnicity = str_to_lower(ethnicity)) %>%
  mutate(ethnicity = replace(ethnicity, ethnicity == "asian and pacific islander" | ethnicity == "asian and paci", "asain and pacific")) %>%
  mutate(ethnicity = replace(ethnicity, ethnicity == "white non hisp", "white non hispanic")) %>%
  mutate(ethnicity = replace(ethnicity, ethnicity == "black non hisp", "black non hispanic")) %>%
  unique()


oliva_table = baby_df %>%
  filter(childs_first_name == "Olivia") %>%
  select(-count, -gender,-childs_first_name) %>%
  pivot_wider(names_from = year_of_birth, values_from = rank)


male_table = baby_df %>%
  filter(gender == "male", rank == 1) %>%
  select(-count, -gender, -rank) %>%
  pivot_wider(names_from = year_of_birth, values_from = childs_first_name)


plot_df = baby_df %>%
  filter(gender == "male", ethnicity == "white non hispanic", year_of_birth == 2016)

ggplot(plot_df, aes(x = rank, y = count)) + geom_point()
```


















